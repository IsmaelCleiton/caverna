---
import { getCollection, render, type CollectionEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import LinedPaper from "../../layouts/LinedPaper.astro";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post: any) => ({
        params: { slug: post.data.slug },
        props: post,
    }));
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await render(post);
---

<Layout title={post.data.title}>
    <LinedPaper>
        <article>
            <h1>{post.data.title}</h1>
            <div>
                {
                    post.data.tags && post.data.tags.length > 0 && (
                        <div class="tags-container">
                            {post.data.tags.map((tag: string) => (
                                <div class="post-tag">
                                    <small class="tag">{tag}</small>
                                </div>
                            ))}
                        </div>
                    )
                }
            </div>
            <p class="date">
                Publicado em: {
                    new Date(post.data.pubDate).toLocaleDateString("pt-BR", {
                        day: "2-digit",
                        month: "2-digit",
                        year: "numeric",
                        hour: "2-digit",
                        minute: "2-digit",
                    })
                }
            </p>
            <div class="content">
                <Content />
            </div>
        </article>
    </LinedPaper>
</Layout>
